var te=Object.defineProperty;var P=Object.getOwnPropertySymbols;var ne=Object.prototype.hasOwnProperty,ae=Object.prototype.propertyIsEnumerable;var G=(f,e,o)=>e in f?te(f,e,{enumerable:!0,configurable:!0,writable:!0,value:o}):f[e]=o,M=(f,e)=>{for(var o in e||(e={}))ne.call(e,o)&&G(f,o,e[o]);if(P)for(var o of P(e))ae.call(e,o)&&G(f,o,e[o]);return f};import{J as z,G as q,B as R,a0 as oe,k as O,A as re,r as c,o as m,e as S,h as y,f as n,w as s,u as a,t as h,l as I,F as J,y as se,i as L,m as ie,j as k,ah as le,aN as W,V as ce,C as ue}from"./vendor.d12b5734.js";import{t as A,e as K,g as D,j as de}from"./main.e76e527e.js";import{L as me}from"./LoadingIcon.49d4db26.js";import{_ as _e}from"./InvoiceIndexDropdown.63f41194.js";import{_ as ve}from"./SendInvoiceModal.54a823df.js";import{_ as ge}from"./RecurringInvoiceIndexDropdown.4cb41f2a.js";import"./mail-driver.8a16a132.js";const pe={class:"fixed top-0 left-0 hidden h-full pt-16 pb-[6.4rem] ml-56 bg-white xl:ml-64 w-88 xl:block"},fe={class:"flex items-center justify-between px-4 pt-8 pb-2 border border-gray-200 border-solid height-full"},be={class:"mb-6"},ye={class:"flex mb-6 ml-3",role:"group","aria-label":"First group"},Ie={class:"px-2 py-1 pb-2 mb-1 mb-2 text-sm border-b border-gray-200 border-solid"},Be={class:"flex-2"},he={class:"mt-1 mb-2 text-xs not-italic font-medium leading-5 text-gray-600"},xe={class:"flex-1 whitespace-nowrap right"},we={class:"text-sm not-italic font-normal leading-5 text-right text-gray-600 est-date"},Re={key:0,class:"flex justify-center p-4 items-center"},ke={key:1,class:"flex justify-center px-4 mt-5 text-sm text-gray-600"},$e={setup(f){const e=A();z();const o=q(),i=R(!1),_=R(null),u=R(1),b=R(1),x=R(null),t=oe({orderBy:null,orderByField:null,searchText:null}),F=O(()=>t.orderBy==="asc"||t.orderBy==null);function C(r){return o.params.id==r}async function B(r,v=!1){if(i.value)return;let g={};t.searchText!==""&&t.searchText!==null&&t.searchText!==void 0&&(g.search=t.searchText),t.orderBy!==null&&t.orderBy!==void 0&&(g.orderBy=t.orderBy),t.orderByField!==null&&t.orderByField!==void 0&&(g.orderByField=t.orderByField),i.value=!0;let $=await e.fetchRecurringInvoices(M({page:r},g));i.value=!1,_.value=_.value?_.value:[],_.value=[..._.value,...$.data.data],u.value=r||1,b.value=$.data.meta.last_page;let w=_.value.find(V=>V.id==o.params.id);v==!1&&!w&&u.value<b.value&&Object.keys(g).length===0&&B(++u.value),w&&setTimeout(()=>{v==!1&&E()},500)}function E(){const r=document.getElementById(`recurring-invoice-${o.params.id}`);r&&(r.scrollIntoView({behavior:"smooth"}),r.classList.add("shake"),d())}function d(){x.value.addEventListener("scroll",r=>{r.target.scrollTop>0&&r.target.scrollTop+r.target.clientHeight>r.target.scrollHeight-200&&u.value<b.value&&B(++u.value,!0)})}async function p(){_.value=[],B()}function j(){return t.orderBy==="asc"?(t.orderBy="desc",p(),!0):(t.orderBy="asc",p(),!0)}return B(),p=re.exports.debounce(p,500),(r,v)=>{var H;const g=c("BaseIcon"),$=c("BaseInput"),w=c("BaseButton"),V=c("BaseRadio"),T=c("BaseInputGroup"),N=c("BaseDropdownItem"),Q=c("BaseDropdown"),X=c("BaseText"),Y=c("BaseRecurringInvoiceStatusBadge"),Z=c("BaseFormatMoney"),ee=c("router-link");return m(),S("div",pe,[y("div",fe,[y("div",be,[n($,{modelValue:a(t).searchText,"onUpdate:modelValue":v[0]||(v[0]=l=>a(t).searchText=l),placeholder:r.$t("general.search"),type:"text",variant:"gray",onInput:v[1]||(v[1]=l=>p())},{right:s(()=>[n(g,{name:"SearchIcon",class:"h-5 text-gray-400"})]),_:1},8,["modelValue","placeholder"])]),y("div",ye,[n(Q,{class:"ml-3",position:"bottom-start"},{activator:s(()=>[n(w,{size:"md",variant:"gray"},{default:s(()=>[n(g,{name:"FilterIcon",class:"h-5"})]),_:1})]),default:s(()=>[y("div",Ie,h(r.$t("general.sort_by")),1),n(N,{class:"flex px-1 py-2 cursor-pointer"},{default:s(()=>[n(T,{class:"-mt-3 font-normal"},{default:s(()=>[n(V,{id:"filter_next_invoice_date",modelValue:a(t).orderByField,"onUpdate:modelValue":[v[2]||(v[2]=l=>a(t).orderByField=l),p],label:r.$t("recurring_invoices.next_invoice_date"),size:"sm",name:"filter",value:"next_invoice_at"},null,8,["modelValue","label"])]),_:1})]),_:1}),n(N,{class:"flex px-1 py-2 cursor-pointer"},{default:s(()=>[n(T,{class:"-mt-3 font-normal"},{default:s(()=>[n(V,{id:"filter_start_date",modelValue:a(t).orderByField,"onUpdate:modelValue":[v[3]||(v[3]=l=>a(t).orderByField=l),p],label:r.$t("recurring_invoices.starts_at"),value:"starts_at",size:"sm",name:"filter"},null,8,["modelValue","label"])]),_:1})]),_:1})]),_:1}),n(w,{class:"ml-1",size:"md",variant:"gray",onClick:j},{default:s(()=>[a(F)?(m(),I(g,{key:0,name:"SortAscendingIcon",class:"h-5"})):(m(),I(g,{key:1,name:"SortDescendingIcon",class:"h-5"}))]),_:1})])]),y("div",{ref:(l,U)=>{U.invoiceListSection=l,x.value=l},class:"h-full overflow-y-scroll border-l border-gray-200 border-solid base-scroll"},[(m(!0),S(J,null,se(_.value,(l,U)=>(m(),S("div",{key:U},[l?(m(),I(ee,{key:0,id:"recurring-invoice-"+l.id,to:`/admin/recurring-invoices/${l.id}/view`,class:ie(["flex justify-between side-invoice p-4 cursor-pointer hover:bg-gray-100 items-center border-l-4 border-transparent",{"bg-gray-100 border-l-4 border-primary-500 border-solid":C(l.id)}]),style:{"border-bottom":"1px solid rgba(185, 193, 209, 0.41)"}},{default:s(()=>[y("div",Be,[n(X,{text:l.customer.name,length:30,class:"pr-2 mb-2 text-sm not-italic font-normal leading-5 text-black capitalize truncate"},null,8,["text"]),y("div",he,h(l.invoice_number),1),n(Y,{status:l.status,class:"px-1 text-xs"},{default:s(()=>[L(h(l.status),1)]),_:2},1032,["status"])]),y("div",xe,[n(Z,{class:"block mb-2 text-xl not-italic font-semibold leading-8 text-right text-gray-900",amount:l.total,currency:l.customer.currency},null,8,["amount","currency"]),y("div",we,h(l.formatted_starts_at),1)])]),_:2},1032,["id","to","class"])):k("",!0)]))),128)),i.value?(m(),S("div",Re,[n(me,{class:"h-6 m-1 animate-spin text-primary-400"})])):k("",!0),!((H=_.value)==null?void 0:H.length)&&!i.value?(m(),S("p",ke,h(r.$t("invoices.no_matching_invoices")),1)):k("",!0)],512)])}}},Ve={class:"relative table-container"},Ee={setup(f){const e=A(),o=R(null);R(null),le("$utils");const{t:i}=z();R(null),W();const _=K(),u=O(()=>[{key:"invoice_date",label:i("invoices.date"),thClass:"extra",tdClass:"font-medium text-gray-900"},{key:"invoice_number",label:i("invoices.invoice")},{key:"customer.name",label:i("invoices.customer")},{key:"status",label:i("invoices.status")},{key:"total",label:i("invoices.total")},{key:"actions",label:i("invoices.action"),tdClass:"text-right text-sm font-medium",thClass:"text-right",sortable:!1}]);function b(){return _.hasAbilities([D.DELETE_INVOICE,D.EDIT_INVOICE,D.VIEW_INVOICE,D.SEND_INVOICE])}return(x,t)=>{const F=c("router-link"),C=c("BaseFormatMoney"),B=c("BaseInvoiceStatusBadge"),E=c("BaseTable");return m(),S(J,null,[n(ve),y("div",Ve,[n(E,{ref:(d,p)=>{p.table=d,o.value=d},data:a(e).newRecurringInvoice.invoices,columns:a(u),loading:a(e).isFetchingViewData,"placeholder-count":5,class:"mt-5"},ce({"cell-invoice_number":s(({row:d})=>[n(F,{to:{path:`/admin/invoices/${d.data.id}/view`},class:"font-medium text-primary-500"},{default:s(()=>[L(h(d.data.invoice_number),1)]),_:2},1032,["to"])]),"cell-total":s(({row:d})=>[n(C,{amount:d.data.due_amount,currency:d.data.currency},null,8,["amount","currency"])]),"cell-status":s(({row:d})=>[n(B,{status:d.data.status,class:"px-3 py-1"},{default:s(()=>[L(h(d.data.status),1)]),_:2},1032,["status"])]),_:2},[b()?{name:"cell-actions",fn:s(({row:d})=>[n(_e,{row:d.data,table:o.value},null,8,["row","table"])])}:void 0]),1032,["data","columns","loading"])])],64)}}},Se={setup(f){const e=A(),o=q();let i=O(()=>e.isFetchingViewData);ue(o,()=>{o.params.id&&o.name==="recurring-invoices.view"&&_()},{immediate:!0});async function _(){await e.fetchRecurringInvoice(o.params.id)}return(u,b)=>{const x=c("BaseHeading"),t=c("BaseDescriptionListItem"),F=c("BaseDescriptionList"),C=c("BaseCard");return m(),I(C,{class:"mt-10"},{default:s(()=>[n(x,null,{default:s(()=>[L(h(u.$t("customers.basic_info")),1)]),_:1}),n(F,{class:"mt-5"},{default:s(()=>{var B,E,d,p,j,r,v,g,$,w,V,T,N;return[n(t,{label:u.$t("recurring_invoices.starts_at"),"content-loading":a(i),value:(B=a(e).newRecurringInvoice)==null?void 0:B.formatted_starts_at},null,8,["label","content-loading","value"]),n(t,{label:u.$t("recurring_invoices.next_invoice_date"),"content-loading":a(i),value:(E=a(e).newRecurringInvoice)==null?void 0:E.formatted_next_invoice_at},null,8,["label","content-loading","value"]),((d=a(e).newRecurringInvoice)==null?void 0:d.limit_date)&&((p=a(e).newRecurringInvoice)==null?void 0:p.limit_by)!=="NONE"?(m(),I(t,{key:0,label:u.$t("recurring_invoices.limit_date"),"content-loading":a(i),value:(j=a(e).newRecurringInvoice)==null?void 0:j.limit_date},null,8,["label","content-loading","value"])):k("",!0),((r=a(e).newRecurringInvoice)==null?void 0:r.limit_date)&&((v=a(e).newRecurringInvoice)==null?void 0:v.limit_by)!=="NONE"?(m(),I(t,{key:1,label:u.$t("recurring_invoices.limit_by"),"content-loading":a(i),value:(g=a(e).newRecurringInvoice)==null?void 0:g.limit_by},null,8,["label","content-loading","value"])):k("",!0),(($=a(e).newRecurringInvoice)==null?void 0:$.limit_count)?(m(),I(t,{key:2,label:u.$t("recurring_invoices.limit_count"),value:(w=a(e).newRecurringInvoice)==null?void 0:w.limit_count,"content-loading":a(i)},null,8,["label","value","content-loading"])):k("",!0),((V=a(e).newRecurringInvoice)==null?void 0:V.selectedFrequency)?(m(),I(t,{key:3,label:u.$t("recurring_invoices.frequency.title"),value:(N=(T=a(e).newRecurringInvoice)==null?void 0:T.selectedFrequency)==null?void 0:N.label,"content-loading":a(i)},null,8,["label","value","content-loading"])):k("",!0)]}),_:1}),n(x,{class:"mt-8"},{default:s(()=>[L(h(u.$t("invoices.title",2)),1)]),_:1}),n(Ee)]),_:1})}}},Ae={setup(f){de();const e=A(),o=K();z(),W();const i=O(()=>{var u,b;return e.newRecurringInvoice?(b=(u=e.newRecurringInvoice)==null?void 0:u.customer)==null?void 0:b.name:""});function _(){return o.hasAbilities([D.DELETE_RECURRING_INVOICE,D.EDIT_RECURRING_INVOICE])}return(u,b)=>{const x=c("BasePageHeader"),t=c("BasePage");return m(),I(t,{class:"xl:pl-96"},{default:s(()=>[n(x,{title:a(i)},{actions:s(()=>[_()?(m(),I(ge,{key:0,row:a(e).newRecurringInvoice},null,8,["row"])):k("",!0)]),_:1},8,["title"]),n($e),n(Se)]),_:1})}}};export{Ae as default};
